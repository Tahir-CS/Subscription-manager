# ğŸ—ï¸ Architecture Diagram

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER'S BROWSER                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    SUBSCRIPTION PAGE                        â”‚ â”‚
â”‚  â”‚  (Netflix, Spotify, Adobe, etc.)                           â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  [Free Trial] [Pricing] [Auto-Renew Notice]               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â”‚ (1) Content Script Analyzes           â”‚
â”‚                         â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              CONTENT SCRIPT (content.js)                    â”‚ â”‚
â”‚  â”‚  â€¢ Scans page text                                          â”‚ â”‚
â”‚  â”‚  â€¢ Detects keywords (trial, subscription, renew)           â”‚ â”‚
â”‚  â”‚  â€¢ Extracts data (price, dates, terms)                     â”‚ â”‚
â”‚  â”‚  â€¢ Calculates risk score                                   â”‚ â”‚
â”‚  â”‚  â€¢ Shows in-page alert                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â”‚ (2) Sends Message                     â”‚
â”‚                         â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           BACKGROUND SERVICE WORKER                         â”‚ â”‚
â”‚  â”‚              (background.js)                                â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â€¢ Receives detection events                               â”‚ â”‚
â”‚  â”‚  â€¢ Manages storage operations                              â”‚ â”‚
â”‚  â”‚  â€¢ Schedules alarms/notifications                          â”‚ â”‚
â”‚  â”‚  â€¢ Updates extension badge                                 â”‚ â”‚
â”‚  â”‚  â€¢ Monitors renewals (hourly)                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚                      â”‚                         â”‚
â”‚  (3) Save       â”‚                      â”‚ (5) Trigger            â”‚
â”‚                 â–¼                      â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  CHROME STORAGE    â”‚   â”‚   CHROME ALARMS + NOTIFICATIONS â”‚  â”‚
â”‚  â”‚   (Local API)      â”‚   â”‚                                 â”‚  â”‚
â”‚  â”‚                    â”‚   â”‚  â€¢ 48h before renewal           â”‚  â”‚
â”‚  â”‚  subscriptions: [] â”‚   â”‚  â€¢ 12h before renewal           â”‚  â”‚
â”‚  â”‚  settings: {}      â”‚   â”‚  â€¢ Browser notifications        â”‚  â”‚
â”‚  â”‚  userId: "..."     â”‚   â”‚  â€¢ Badge alerts                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â”‚                                                  â”‚
â”‚               â”‚ (4) Retrieve                                    â”‚
â”‚               â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                 POPUP UI (popup.js)                         â”‚ â”‚
â”‚  â”‚                  React Dashboard                            â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚ â”‚
â”‚  â”‚  â”‚  Summary Cards                                â”‚         â”‚ â”‚
â”‚  â”‚  â”‚  [Active: 3] [Trials: 1] [Monthly: $47]     â”‚         â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚ â”‚
â”‚  â”‚  â”‚  Subscription List                            â”‚         â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ Netflix      $14.99/mo    HIGH RISK   â”‚  â”‚         â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ Renews in 2 days                       â”‚  â”‚         â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ [Visit] [Cancel] [Delete]              â”‚  â”‚         â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagram

```
USER VISITS SUBSCRIPTION PAGE
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Page Analysis      â”‚
â”‚  - Extract text     â”‚
â”‚  - Check DOM        â”‚
â”‚  - Find patterns    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Detection Logic    â”‚
â”‚  - Keyword match    â”‚
â”‚  - Price extraction â”‚
â”‚  - Risk scoring     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Show Alert?        â”‚
â”‚  If detected: YES   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  In-Page Alert      â”‚
â”‚  [Track] [Dismiss]  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ User clicks Track
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tracking Dialog    â”‚
â”‚  Pre-filled form    â”‚
â”‚  [Add to Guardian]  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Save to Storage    â”‚
â”‚  + Schedule Alarms  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dashboard Updates  â”‚
â”‚  Show in popup      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Interaction

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Content       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Background    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Popup         â”‚
â”‚  Script        â”‚         â”‚  Worker        â”‚         â”‚  Dashboard     â”‚
â”‚                â”‚         â”‚                â”‚         â”‚                â”‚
â”‚  â€¢ Detection   â”‚  (msg)  â”‚  â€¢ Storage     â”‚  (get)  â”‚  â€¢ Display     â”‚
â”‚  â€¢ Alert       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  â€¢ Alarms      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  â€¢ Manage      â”‚
â”‚  â€¢ Dialog      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â€¢ Notify      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â€¢ Analytics   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  (resp) â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  (save) â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                           â”‚                          â”‚
        â”‚                           â”‚                          â”‚
        â–¼                           â–¼                          â–¼
   [PAGE DOM]                [CHROME APIs]               [REACT UI]
   â€¢ Read text               â€¢ storage.local              â€¢ Components
   â€¢ Insert HTML             â€¢ alarms                     â€¢ State
   â€¢ Listen events           â€¢ notifications              â€¢ Effects
```

## File Structure & Responsibilities

```
src/
â”‚
â”œâ”€â”€ background/
â”‚   â””â”€â”€ background.ts
â”‚       â”œâ”€â”€ onInstalled()         â†’ Initialize extension
â”‚       â”œâ”€â”€ onMessage()           â†’ Handle messages from content
â”‚       â”œâ”€â”€ onAlarm()             â†’ Check renewals, send reminders
â”‚       â”œâ”€â”€ scheduleReminders()   â†’ Create alarms for subscriptions
â”‚       â””â”€â”€ sendNotification()    â†’ Browser notifications
â”‚
â”œâ”€â”€ content/
â”‚   â””â”€â”€ content.ts
â”‚       â”œâ”€â”€ analyzePage()         â†’ Scan page for subscriptions
â”‚       â”œâ”€â”€ showInPageAlert()     â†’ Display detection alert
â”‚       â”œâ”€â”€ openTrackingDialog()  â†’ Show tracking form
â”‚       â””â”€â”€ MutationObserver      â†’ Detect SPA navigation
â”‚
â”œâ”€â”€ popup/
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”œâ”€â”€ <Header>              â†’ Branding, title
â”‚   â”‚   â”œâ”€â”€ <SummaryCards>        â†’ Stats overview
â”‚   â”‚   â”œâ”€â”€ <Tabs>                â†’ All/Trials/Active filter
â”‚   â”‚   â””â”€â”€ <SubscriptionCard>    â†’ Individual subscription
â”‚   â””â”€â”€ index.tsx                 â†’ React mount point
â”‚
â”œâ”€â”€ types/
â”‚   â””â”€â”€ index.ts
â”‚       â”œâ”€â”€ Subscription          â†’ Data model
â”‚       â”œâ”€â”€ DetectionResult       â†’ Detection output
â”‚       â”œâ”€â”€ NotificationConfig    â†’ Reminder settings
â”‚       â””â”€â”€ StorageData           â†’ Storage schema
â”‚
â””â”€â”€ utils/
    â”œâ”€â”€ detector.ts
    â”‚   â”œâ”€â”€ detectSubscriptionPage()  â†’ Main detection
    â”‚   â”œâ”€â”€ calculateRiskScore()      â†’ Risk algorithm
    â”‚   â”œâ”€â”€ extractServiceName()      â†’ Parse URL
    â”‚   â””â”€â”€ formatDate()              â†’ Date utilities
    â”‚
    â””â”€â”€ storage.ts
        â”œâ”€â”€ getSubscriptions()        â†’ Fetch all
        â”œâ”€â”€ addSubscription()         â†’ Save new
        â”œâ”€â”€ updateSubscription()      â†’ Modify existing
        â”œâ”€â”€ deleteSubscription()      â†’ Remove
        â””â”€â”€ calculateBurnRate()       â†’ Analytics
```

## Risk Scoring Algorithm

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      RISK SCORE CALCULATION         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Base Score = 0                     â”‚
â”‚                                     â”‚
â”‚  + Trial Length Risk:               â”‚
â”‚    â€¢ < 7 days    â†’ +35 pts         â”‚
â”‚    â€¢ 7-14 days   â†’ +20 pts         â”‚
â”‚    â€¢ > 14 days   â†’ +10 pts         â”‚
â”‚                                     â”‚
â”‚  + Dark Patterns:                   â”‚
â”‚    â€¢ Each detected â†’ +10 pts       â”‚
â”‚      (countdown, limited time,      â”‚
â”‚       pre-checked, hidden cancel)   â”‚
â”‚                                     â”‚
â”‚  + Auto-Renew:                      â”‚
â”‚    â€¢ If detected  â†’ +15 pts        â”‚
â”‚                                     â”‚
â”‚  + Billing Frequency:               â”‚
â”‚    â€¢ Monthly      â†’ +10 pts        â”‚
â”‚    â€¢ Yearly       â†’ +5 pts         â”‚
â”‚                                     â”‚
â”‚  Total = min(100, sum above)       â”‚
â”‚                                     â”‚
â”‚  Classification:                    â”‚
â”‚    â€¢ 0-29   â†’ Low Risk    (ğŸŸ¢)    â”‚
â”‚    â€¢ 30-69  â†’ Moderate    (ğŸŸ¡)    â”‚
â”‚    â€¢ 70-100 â†’ High Risk   (ğŸ”´)    â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Detection Keywords Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             KEYWORD DETECTION LOGIC                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                       â”‚
â”‚  SUBSCRIPTION KEYWORDS (10)                          â”‚
â”‚  â”œâ”€ "subscription"        â†’ +10 pts                  â”‚
â”‚  â”œâ”€ "recurring"           â†’ +10 pts                  â”‚
â”‚  â”œâ”€ "auto-renew"          â†’ +10 pts + flag           â”‚
â”‚  â”œâ”€ "monthly plan"        â†’ +10 pts                  â”‚
â”‚  â””â”€ ...                                              â”‚
â”‚                                                       â”‚
â”‚  TRIAL KEYWORDS (7)                                  â”‚
â”‚  â”œâ”€ "free trial"          â†’ +15 pts + detect         â”‚
â”‚  â”œâ”€ "trial period"        â†’ +15 pts                  â”‚
â”‚  â”œâ”€ "start trial"         â†’ +15 pts                  â”‚
â”‚  â””â”€ ...                                              â”‚
â”‚                                                       â”‚
â”‚  PRICING KEYWORDS (6)                                â”‚
â”‚  â”œâ”€ "/month", "/mo"       â†’ billing = monthly        â”‚
â”‚  â”œâ”€ "/year", "annual"     â†’ billing = yearly         â”‚
â”‚  â””â”€ ...                                              â”‚
â”‚                                                       â”‚
â”‚  DARK PATTERN KEYWORDS (6)                           â”‚
â”‚  â”œâ”€ "limited time"        â†’ +10 pts + flag           â”‚
â”‚  â”œâ”€ "offer ends"          â†’ +10 pts + flag           â”‚
â”‚  â”œâ”€ "act now"             â†’ +10 pts + flag           â”‚
â”‚  â””â”€ ...                                              â”‚
â”‚                                                       â”‚
â”‚  THRESHOLD: Score > 20 â†’ Subscription Detected       â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## State Management Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               STATE MANAGEMENT                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  Chrome Storage (Local)                             â”‚
â”‚  â”œâ”€ subscriptions: Subscription[]                   â”‚
â”‚  â”œâ”€ settings: UserSettings                          â”‚
â”‚  â””â”€ userId: string                                  â”‚
â”‚                                                      â”‚
â”‚  â–¼ Accessed by â–¼                                    â”‚
â”‚                                                      â”‚
â”‚  Background Worker                                   â”‚
â”‚  â”œâ”€ CRUD operations                                 â”‚
â”‚  â”œâ”€ Scheduled checks                                â”‚
â”‚  â””â”€ Notification triggers                           â”‚
â”‚                                                      â”‚
â”‚  Popup React                                         â”‚
â”‚  â”œâ”€ useState() for local state                      â”‚
â”‚  â”œâ”€ useEffect() to fetch on mount                   â”‚
â”‚  â””â”€ Storage API for persistence                     â”‚
â”‚                                                      â”‚
â”‚  Content Script                                      â”‚
â”‚  â””â”€ Read-only (sends to background)                 â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Notification Timeline

```
Day 0:  User starts trial
        â”œâ”€ Subscription tracked
        â”œâ”€ Alarms scheduled
        â””â”€ Stored in Chrome Storage

Day 5:  (for 7-day trial)
        â””â”€ (48h before renewal)
            â”œâ”€ Alarm triggers
            â”œâ”€ Notification sent: "2 days left!"
            â””â”€ Badge updated

Day 6:  
        â””â”€ (12h before renewal)
            â”œâ”€ Alarm triggers
            â”œâ”€ Notification sent: "12 hours left!"
            â””â”€ Badge urgent

Day 7:  Trial ends
        â”œâ”€ First charge
        â”œâ”€ Status: trial â†’ active
        â””â”€ Next alarm: 30 days (for monthly)
```

## Technology Stack Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PRESENTATION LAYER               â”‚
â”‚  React 18 Â· TypeScript Â· CSS-in-JS      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          BUSINESS LOGIC                  â”‚
â”‚  Detection Â· Risk Scoring Â· Analytics   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         CHROME APIS LAYER                â”‚
â”‚  Storage Â· Alarms Â· Notifications        â”‚
â”‚  Tabs Â· Scripting Â· Runtime              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          BUILD LAYER                     â”‚
â”‚  Webpack 5 Â· TypeScript Compiler         â”‚
â”‚  ts-loader Â· CopyPlugin                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Quick Reference

**Entry Points:**
- `background.ts` â†’ Service worker (background tasks)
- `content.ts` â†’ Page analysis (detection)
- `popup/index.tsx` â†’ Dashboard UI (user interface)

**Key Functions:**
- `detectSubscriptionPage()` â†’ Main detection
- `calculateRiskScore()` â†’ Risk algorithm
- `scheduleRenewalReminders()` â†’ Set alarms
- `Storage.addSubscription()` â†’ Save data

**Chrome APIs Used:**
- `chrome.storage.local` â†’ Persistence
- `chrome.alarms` â†’ Scheduled tasks
- `chrome.notifications` â†’ User alerts
- `chrome.runtime.sendMessage()` â†’ Communication
- `chrome.action.setBadgeText()` â†’ Icon badge

---

**This architecture supports:**
âœ… Real-time detection  
âœ… Persistent storage  
âœ… Scheduled reminders  
âœ… Beautiful UI  
âœ… Privacy-first approach  

**Ready for scale and additional features!**
